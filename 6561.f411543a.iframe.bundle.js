"use strict";(self.webpackChunkplatform_ui=self.webpackChunkplatform_ui||[]).push([[6561],{"./apps/acp-ui/src/app/enums/supportedLanguages.enum.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var AcpSupportedLanguesEnum,AcpSupportedLanguesLongCodeEnum,AcpLanguageCodeSwitchEnum,AcpSupportedLanguagesFullEnum;__webpack_require__.d(__webpack_exports__,{JS:()=>AcpLanguageCodeSwitchEnum,V7:()=>AcpSupportedLanguesEnum,kV:()=>AcpSupportedLanguesLongCodeEnum}),function(AcpSupportedLanguesEnum){AcpSupportedLanguesEnum.en="en",AcpSupportedLanguesEnum.fr="fr",AcpSupportedLanguesEnum.zh="zh",AcpSupportedLanguesEnum.de="de",AcpSupportedLanguesEnum.ja="ja",AcpSupportedLanguesEnum.pt="pt",AcpSupportedLanguesEnum.es="es",AcpSupportedLanguesEnum.ko="ko"}(AcpSupportedLanguesEnum||(AcpSupportedLanguesEnum={})),function(AcpSupportedLanguesLongCodeEnum){AcpSupportedLanguesLongCodeEnum.en="eng",AcpSupportedLanguesLongCodeEnum.fr="fra",AcpSupportedLanguesLongCodeEnum.zh="zho",AcpSupportedLanguesLongCodeEnum.de="deu",AcpSupportedLanguesLongCodeEnum.ja="jpn",AcpSupportedLanguesLongCodeEnum.pt="por",AcpSupportedLanguesLongCodeEnum.es="esp",AcpSupportedLanguesLongCodeEnum.ko="kor"}(AcpSupportedLanguesLongCodeEnum||(AcpSupportedLanguesLongCodeEnum={})),function(AcpLanguageCodeSwitchEnum){AcpLanguageCodeSwitchEnum.eng="en",AcpLanguageCodeSwitchEnum.fra="fr",AcpLanguageCodeSwitchEnum.zho="zh",AcpLanguageCodeSwitchEnum.deu="de",AcpLanguageCodeSwitchEnum.jpn="ja",AcpLanguageCodeSwitchEnum.por="pt",AcpLanguageCodeSwitchEnum.esp="es",AcpLanguageCodeSwitchEnum.kor="ko"}(AcpLanguageCodeSwitchEnum||(AcpLanguageCodeSwitchEnum={})),function(AcpSupportedLanguagesFullEnum){AcpSupportedLanguagesFullEnum.EN="English",AcpSupportedLanguagesFullEnum.ZH="Chinese",AcpSupportedLanguagesFullEnum.FR="French",AcpSupportedLanguagesFullEnum.DE="German",AcpSupportedLanguagesFullEnum.JA="Japanese",AcpSupportedLanguagesFullEnum.PT="Portuguese",AcpSupportedLanguagesFullEnum.ES="Spanish"}(AcpSupportedLanguagesFullEnum||(AcpSupportedLanguagesFullEnum={}))},"./libs/ui/src/lib/enums/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var UiEnvironmentNameEnum;__webpack_require__.d(__webpack_exports__,{C:()=>UiEnvironmentNameEnum,q:()=>modal_dialog_size_enum.q}),function(UiEnvironmentNameEnum){UiEnvironmentNameEnum.localdev="localdev",UiEnvironmentNameEnum.production="production",UiEnvironmentNameEnum.eucloudprod="eucloud-prod",UiEnvironmentNameEnum.qa="qa",UiEnvironmentNameEnum.qa2="qa2",UiEnvironmentNameEnum.qa3="qa3",UiEnvironmentNameEnum.staging="staging",UiEnvironmentNameEnum.uat="uat",UiEnvironmentNameEnum.dev112="dev112",UiEnvironmentNameEnum.devopsprod="devops-prod",UiEnvironmentNameEnum.devopssandbox="devops-sandbox"}(UiEnvironmentNameEnum||(UiEnvironmentNameEnum={}));var modal_dialog_size_enum=__webpack_require__("./libs/ui/src/lib/enums/modal-dialog-size.enum.ts")},"./libs/ui/src/lib/enums/modal-dialog-size.enum.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var UiModalDialogSizeEnum;__webpack_require__.d(__webpack_exports__,{q:()=>UiModalDialogSizeEnum}),function(UiModalDialogSizeEnum){UiModalDialogSizeEnum.sm="sm",UiModalDialogSizeEnum.md="md",UiModalDialogSizeEnum.lg="lg",UiModalDialogSizeEnum.xl="xl"}(UiModalDialogSizeEnum||(UiModalDialogSizeEnum={}))},"./libs/ui/src/lib/services/analytics/pendo/pendo.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{I:()=>UiPendoService});var UiPendoService_1,tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/tslib/tslib.es6.js"),_angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@angular/core/fesm2020/core.mjs");let UiPendoService=UiPendoService_1=class UiPendoService{constructor(){this.pendoApiKey=""}initVisitorInfo(){try{UiPendoService_1._isPendoInitialized||(pendo.initialize({visitor:UiPendoService_1._visitorInfo}),UiPendoService_1._isPendoInitialized=!0)}catch(error){console.error("Error while initializing Pendo, "+error)}}setVisitorEnvironment(environment){UiPendoService_1._visitorInfo.environment=environment}setUserInitialFields(userName){const domain=userName.split("@").pop();UiPendoService_1._accountInfo.id=domain,UiPendoService_1._visitorInfo.id=userName,UiPendoService_1._visitorInfo.email=userName,UiPendoService_1._visitorInfo.domain=domain,UiPendoService_1._isPendoInitialized?pendo.updateOptions({visitor:UiPendoService_1._visitorInfo,account:UiPendoService_1._accountInfo}):(pendo.initialize({visitor:UiPendoService_1._visitorInfo,account:UiPendoService_1._accountInfo}),UiPendoService_1._isPendoInitialized=!0)}setAuthenticatedVisitorInfo(authObj){try{const domain=authObj.email.split("@").pop();UiPendoService_1._accountInfo.id=domain,UiPendoService_1._visitorInfo.id=authObj.email,UiPendoService_1._visitorInfo.email=authObj.email,UiPendoService_1._visitorInfo.roles=authObj.roles.map((role=>role.name)),UiPendoService_1._visitorInfo.domain=domain,UiPendoService_1._isPendoInitialized?pendo.updateOptions({visitor:UiPendoService_1._visitorInfo,account:UiPendoService_1._accountInfo}):(pendo.initialize({visitor:UiPendoService_1._visitorInfo,account:UiPendoService_1._accountInfo}),UiPendoService_1._isPendoInitialized=!0)}catch(error){console.error("Error while updating Pendo, "+error)}}setAuthenticatedVisitorPermissions(permObj){try{const permissions=Object.keys(permObj).filter((key=>permObj[key]));UiPendoService_1._visitorInfo.permissions=permissions,UiPendoService_1._isPendoInitialized&&pendo.updateOptions({visitor:UiPendoService_1._visitorInfo})}catch(error){console.error("Error while updating Pendo, "+error)}}anonymizeVisitorInfo(){try{UiPendoService_1._accountInfo.id=null,UiPendoService_1._visitorInfo.id="",UiPendoService_1._visitorInfo.permissions=null,UiPendoService_1._visitorInfo.roles=null,UiPendoService_1._visitorInfo.domain=null,pendo.clearSession(),pendo.updateOptions({visitor:UiPendoService_1._visitorInfo})}catch(error){console.error("Error while updating Pendo, "+error)}}getVisitorInfo(){return UiPendoService_1._visitorInfo}getAccountInfo(){return UiPendoService_1._accountInfo}initializePendo(userName,pendoKey,environment){UiPendoService_1._isPendoInitialized||(this.pendoApiKey=pendoKey,pendoFunc.init([pendoKey]),pendoFunc.pendoMain()),this.setVisitorEnvironment(environment),this.setUserInitialFields(userName)}preliminaryPendoInit(pendoKey){UiPendoService_1._isPendoInitialized||(pendoFunc.init([pendoKey]),pendoFunc.pendoMain())}trackEvent(eventName,data){try{pendo.track(eventName,data)}catch(error){console.error("Error in pendoTrackEvent, ",error)}}};UiPendoService._isPendoInitialized=!1,UiPendoService._visitorInfo={id:"",domain:null,roles:null,permissions:null,environment:null,email:null},UiPendoService._accountInfo={id:null},UiPendoService=UiPendoService_1=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.Cg)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_1__.Injectable)({providedIn:"root"})],UiPendoService)},"./libs/ui/src/lib/services/authentication/authentication.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{_:()=>UiAuthenticationService});var tslib__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/tslib/tslib.es6.js"),_angular_core__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./node_modules/@angular/core/fesm2020/core.mjs"),_angular_router__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@angular/router/fesm2020/router.mjs"),_angular_common_http__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@angular/common/fesm2020/http.mjs"),rxjs__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/throwError.js"),rxjs_operators__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/take.js"),rxjs_operators__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),rxjs_operators__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/catchError.js"),ngx_cookie_service__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/ngx-cookie-service/__ivy_ngcc__/fesm2015/ngx-cookie-service.js"),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@ngx-translate/core/__ivy_ngcc__/fesm2015/ngx-translate-core.js"),_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@ng-bootstrap/ng-bootstrap/fesm2020/ng-bootstrap.mjs"),_lib_services_user_user_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./libs/ui/src/lib/services/user/user.service.ts"),_lib_services_configuration_configuration_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./libs/ui/src/lib/services/configuration/configuration.service.ts"),_lib_services_toast_notification_toast_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./libs/ui/src/lib/services/toast-notification/toast.service.ts"),_lib_services_toast_notification_enums__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./libs/ui/src/lib/services/toast-notification/enums/index.ts"),_lib_enums__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./libs/ui/src/lib/enums/index.ts");let UiAuthenticationService=class UiAuthenticationService{constructor(_handler,_router,_userService,_configService,_cookieService,_modalService,_translate,_toastService){this._handler=_handler,this._router=_router,this._userService=_userService,this._configService=_configService,this._cookieService=_cookieService,this._modalService=_modalService,this._translate=_translate,this._toastService=_toastService,this.assentContextKey="",this._loginPath="login/password",this._httpClient=new _angular_common_http__WEBPACK_IMPORTED_MODULE_5__.Qq(this._handler),this._configService.configLoaded$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.s)(1)).subscribe((()=>{this._cookieDomain=this.getCookieDomain();const token=this._cookieService.get(this._configService.appConfig.authCookieId),sessionKey=this._cookieService.get(this._configService.appConfig.sessionCookieId),uniqueSessionGuid=this._cookieService.get(this._configService.appConfig.uniqueSessionCookieId);token&&sessionKey&&(this.authResponse||(this.authResponse={session:{sessionKey:"",token:"",uniqueSessionGuid:""}}),this.authResponse.session={token,sessionKey,uniqueSessionGuid},this.loadUserDetails(token),this.initAssentSession())}))}isLoggedIn(){const token=this._cookieService.get(this._configService.appConfig.authCookieId),tokenExpirationDate=this.getTokenExpirationDate(token);this._cookieDomain=this.getCookieDomain();const sessionKey=this._cookieService.get(this._configService.appConfig.sessionCookieId),uniqueSessionGuid=this._cookieService.get(this._configService.appConfig.uniqueSessionCookieId);return token&&sessionKey&&(this.authResponse||(this.authResponse={session:{sessionKey:"",token:"",uniqueSessionGuid:""}}),this.authResponse.session={token,sessionKey,uniqueSessionGuid},this.loadUserDetails(token),this.initAssentSession()),!!tokenExpirationDate&&Date.now()<tokenExpirationDate}isAssentee(){const token=this._cookieService.get(this._configService.appConfig.authCookieId),email=this.getTokenEmail(token);return email.endsWith("@assent.com")||email.endsWith("@assentcompliance.com")}loginCoreAuth(email,password){return this._httpClient.post(`${this._configService.appConfig.authApi}/${this._loginPath}`,{email,password}).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.T)((data=>{const response={session:data};return this.initializeSession(response),response})),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.W)((error=>(error instanceof _angular_common_http__WEBPACK_IMPORTED_MODULE_5__.yz?console.error("Back-end error:",error.message):console.error("Front-end error:",error.message),(0,rxjs__WEBPACK_IMPORTED_MODULE_9__.$)((()=>error))))))}logout(supressTimeoutMessage=!1){const sessionKey=this._cookieService.get(this._configService.appConfig.sessionCookieId);this._httpClient.post(`${this._configService.appConfig.authApi}/login/logout/${sessionKey}`,{}).subscribe(),this.clearUserCredentials(supressTimeoutMessage),this._cookieService.set(this._configService.appConfig.manualLogoutCookieName,"true"),this.authResponse=void 0,this._userService.logout(),this._router.navigate([""])}initializeSession(authData){const expirationDate=new Date(this.getTokenExpirationDate(authData.session.token)),secureCookie=this._configService.appConfig.secureCookie;this._cookieService.set(this._configService.appConfig.authCookieId,authData.session.token,expirationDate,"/",this._cookieDomain,secureCookie),this._cookieService.set(this._configService.appConfig.sessionCookieId,authData.session.sessionKey,expirationDate,"/",this._cookieDomain),this._cookieService.set(this._configService.appConfig.uniqueSessionCookieId,authData.session.uniqueSessionGuid,expirationDate,"/",this._cookieDomain,secureCookie),this.loadUserDetails(authData.session.token),this.initAssentSession()}initAssentSession(){const options={cookieDomain:this._cookieDomain,authenticationApiUrl:this._configService.appConfig.authApi,logoutOverride:()=>{this.clearUserCredentials(),this._modalService.dismissAll(),this._router.navigate([""])},authTokenCookie:this._configService.appConfig.authCookieId,sessionTokenCookie:this._configService.appConfig.sessionCookieId,onExtendSession:()=>"",sessionExpiryLogoutCookieRequired:!0,sessionExpiryLogoutCookieName:this._configService.appConfig.sessionExpiryLogoutCookieName,secureCookie:this._configService.appConfig.secureCookie},cookiePattern=`^(.*;)?\\s*${this._configService.appConfig.authCookieId}\\s*=\\s*[^;]+(.*)?$`;document.cookie.match(cookiePattern)&&Assent.session.initialize(options)}getCookieDomain(){var _a,_b;let domain=this._configService.appConfig.coreAuthCookieDomain;return(null===(_b=null===(_a=window.location)||void 0===_a?void 0:_a.href)||void 0===_b?void 0:_b.indexOf("localhost"))>-1&&(domain="localhost"),domain}loadUserDetails(token){const userEmail=this.getTokenEmail(token),tokenPayload=this.getTokenPayload(token);this._userService.selectUser(userEmail,tokenPayload)}getTokenExpirationDate(token){const data=this.getTokenPayload(token);if(data&&data.exp)return 1e3*data.exp}getTokenEmail(token){const data=this.getTokenPayload(token);return data&&data.sub&&this.authoriseAcpAccess(data.aud,data.sub)?data.sub:""}authoriseAcpAccess(aud,email){let result=!1;const currentEnv=this._configService.appConfig.environmentName;return aud&&0!==aud.length||this.logout(!0),aud.includes("*")&&(email.endsWith("@assent.com")||email.endsWith("@assentcompliance.com"))||aud.includes(window.location.host)||currentEnv===_lib_enums__WEBPACK_IMPORTED_MODULE_4__.C.localdev||currentEnv===_lib_enums__WEBPACK_IMPORTED_MODULE_4__.C.devopsprod||currentEnv===_lib_enums__WEBPACK_IMPORTED_MODULE_4__.C.devopssandbox?result=!0:this.logout(!0),result}getTokenPayload(token){if(!token)return;const tokenParts=token.split(".");if(tokenParts&&!(tokenParts.length<2))try{return JSON.parse(atob(tokenParts[1]))}catch(error){return}}clearUserCredentials(supressTimeoutMessage=!1){supressTimeoutMessage||this.displayUserLogoutNotification(),Assent.session.dispose(),this._cookieService.delete(this._configService.appConfig.authCookieId,"/",this._cookieDomain),this._cookieService.delete(this._configService.appConfig.sessionCookieId,"/",this._cookieDomain),this._cookieService.delete(this._configService.appConfig.uniqueSessionCookieId,"/",this._cookieDomain),this._cookieService.delete(this._configService.appConfig.isConsentGiven,"/",this._cookieDomain),this._cookieService.delete(this._configService.appConfig.isSupplier,"/",this._cookieDomain)}displayUserLogoutNotification(){this._cookieService.get(this._configService.appConfig.sessionExpiryLogoutCookieName)&&(this._cookieService.delete(this._configService.appConfig.sessionExpiryLogoutCookieName),this._translate.get("AUTHENTICATION.SESSION_EXPIRED_LOGOUT").pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.s)(1)).subscribe((res=>{this._toastService.show(res,_lib_services_toast_notification_enums__WEBPACK_IMPORTED_MODULE_3__.O.danger,{autoHide:!1})})))}};UiAuthenticationService.ctorParameters=()=>[{type:_angular_common_http__WEBPACK_IMPORTED_MODULE_5__.JV},{type:_angular_router__WEBPACK_IMPORTED_MODULE_10__.Ix},{type:_lib_services_user_user_service__WEBPACK_IMPORTED_MODULE_0__.b},{type:_lib_services_configuration_configuration_service__WEBPACK_IMPORTED_MODULE_1__.c},{type:ngx_cookie_service__WEBPACK_IMPORTED_MODULE_11__.O},{type:_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_12__.Bq},{type:_ngx_translate_core__WEBPACK_IMPORTED_MODULE_13__.c$},{type:_lib_services_toast_notification_toast_service__WEBPACK_IMPORTED_MODULE_2__.p}],UiAuthenticationService=(0,tslib__WEBPACK_IMPORTED_MODULE_14__.Cg)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_15__.Injectable)({providedIn:"root"}),(0,tslib__WEBPACK_IMPORTED_MODULE_14__.Sn)("design:paramtypes",[_angular_common_http__WEBPACK_IMPORTED_MODULE_5__.JV,_angular_router__WEBPACK_IMPORTED_MODULE_10__.Ix,_lib_services_user_user_service__WEBPACK_IMPORTED_MODULE_0__.b,_lib_services_configuration_configuration_service__WEBPACK_IMPORTED_MODULE_1__.c,ngx_cookie_service__WEBPACK_IMPORTED_MODULE_11__.O,_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_12__.Bq,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_13__.c$,_lib_services_toast_notification_toast_service__WEBPACK_IMPORTED_MODULE_2__.p])],UiAuthenticationService)},"./libs/ui/src/lib/services/configuration/configuration.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>UiConfigurationService});var tslib__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/tslib/tslib.es6.js"),_angular_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@angular/core/fesm2020/core.mjs"),_angular_common_http__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@angular/common/fesm2020/http.mjs"),rxjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Subject.js"),rxjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/throwError.js");let UiConfigurationService=class UiConfigurationService{constructor(handler){this.configLoaded$=new rxjs__WEBPACK_IMPORTED_MODULE_0__.B,this._configFile="assets/configs/app-config.json",this._httpClient=new _angular_common_http__WEBPACK_IMPORTED_MODULE_1__.Qq(handler)}getConfig(name){if(this.appConfig&&this.appConfig[name])return this.appConfig[name]}initializeFromObject(configData){this.appConfig=configData}initializeApp(){return(0,tslib__WEBPACK_IMPORTED_MODULE_2__.sH)(this,void 0,void 0,(function*(){return new Promise(((_resolve,_reject)=>{this._httpClient.get(this._configFile).subscribe({next:configData=>{this.appConfig=configData,this.configLoaded$.next(null)},error:error=>(_reject(!0),(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.$)((()=>error||"Server error"))),complete:()=>{_resolve(!0)}})}))}))}setEnvironmentVariables(env){this.environmentVariables=env}};UiConfigurationService.ctorParameters=()=>[{type:_angular_common_http__WEBPACK_IMPORTED_MODULE_1__.JV}],UiConfigurationService=(0,tslib__WEBPACK_IMPORTED_MODULE_2__.Cg)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.Injectable)({providedIn:"root"}),(0,tslib__WEBPACK_IMPORTED_MODULE_2__.Sn)("design:paramtypes",[_angular_common_http__WEBPACK_IMPORTED_MODULE_1__.JV])],UiConfigurationService)},"./libs/ui/src/lib/services/toast-notification/enums/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var UiToastTypesEnum;__webpack_require__.d(__webpack_exports__,{O:()=>UiToastTypesEnum}),function(UiToastTypesEnum){UiToastTypesEnum.info="info",UiToastTypesEnum.success="success",UiToastTypesEnum.warning="warning",UiToastTypesEnum.danger="danger"}(UiToastTypesEnum||(UiToastTypesEnum={}))},"./libs/ui/src/lib/services/toast-notification/toast.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{p:()=>UiToastService});var tslib__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/tslib/tslib.es6.js"),_angular_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@angular/core/fesm2020/core.mjs"),rxjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/BehaviorSubject.js"),rxjs_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/take.js"),_enums__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./libs/ui/src/lib/services/toast-notification/enums/index.ts");let UiToastService=class UiToastService{constructor(){this._toastsSubject=new rxjs__WEBPACK_IMPORTED_MODULE_1__.t([])}get toasts$(){return this._toastsSubject.asObservable()}show(text,type=_enums__WEBPACK_IMPORTED_MODULE_0__.O.info,options={},toastId){const temp={id:toastId||this.generateId(),text,type,options};this._toastsSubject.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_2__.s)(1)).subscribe((toasts=>{toasts.push(temp),this._toastsSubject.next(toasts)}))}remove(toast){this._toastsSubject.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_2__.s)(1)).subscribe((toasts=>{this._toastsSubject.next(toasts.filter((t=>t.id!==toast.id)))}))}clear(){this._toastsSubject.next([])}generateId(){return(new Date).getTime().toString()}};UiToastService=(0,tslib__WEBPACK_IMPORTED_MODULE_3__.Cg)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_4__.Injectable)({providedIn:"root"})],UiToastService)},"./libs/ui/src/lib/services/user/enums/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var UiPermissionsEnum,UiTokenKeyPermissionsEnum;__webpack_require__.d(__webpack_exports__,{Q:()=>UiPermissionsEnum,U:()=>UiTokenKeyPermissionsEnum}),function(UiPermissionsEnum){UiPermissionsEnum.userManagement="userManagement",UiPermissionsEnum.exceptionManagement="exceptionManagement",UiPermissionsEnum.segmentationReport="segmentationReport",UiPermissionsEnum.editCompanyProfile="editCompanyProfile",UiPermissionsEnum.viewCompanyProfile="viewCompanyProfile",UiPermissionsEnum.viewContactManagement="viewContactManagement",UiPermissionsEnum.editContactManagement="editContactManagement",UiPermissionsEnum.accessDeclarationSearch="accessDeclarationSearch",UiPermissionsEnum.accessTransactionLogs="accessTransactionLogs",UiPermissionsEnum.accessIndirectMonitoring="accessIndirectMonitoring",UiPermissionsEnum.viewIndirectMonitoringRecords="viewIndirectMonitoringRecords",UiPermissionsEnum.addIndirectMonitoringRecords="addIndirectMonitoringRecords",UiPermissionsEnum.editIndirectMonitoringRecords="editIndirectMonitoringRecords",UiPermissionsEnum.deleteIndirectMonitoringRecords="deleteIndirectMonitoringRecords",UiPermissionsEnum.viewIndirectMonitoringKeywordsList="viewIndirectMonitoringKeywordsList",UiPermissionsEnum.addIndirectMonitoringKeywordsList="addIndirectMonitoringKeywordsList",UiPermissionsEnum.editIndirectMonitoringKeywordsList="editIndirectMonitoringKeywordsList",UiPermissionsEnum.deleteIndirectMonitoringKeywordsList="deleteIndirectMonitoringKeywordsList",UiPermissionsEnum.accessCorrectiveActions="accessCorrectiveActions",UiPermissionsEnum.fullViewCorrectiveActionRecords="fullViewCorrectiveActionRecords",UiPermissionsEnum.viewAssignedCorrectiveActionRecords="viewAssignedCorrectiveActionRecords",UiPermissionsEnum.addCorrectiveActionRecords="addCorrectiveActionRecords",UiPermissionsEnum.editCorrectiveActionRecords="editCorrectiveActionRecords",UiPermissionsEnum.deleteCorrectiveActionRecords="deleteCorrectiveActionRecords",UiPermissionsEnum.respondToCorrectiveActions="respondToCorrectiveActions",UiPermissionsEnum.manageCorrectiveActionsRulesSet="manageCorrectiveActionsRulesSet",UiPermissionsEnum.manageCorrectiveActionTemplates="manageCorrectiveActionTemplates",UiPermissionsEnum.createCoreOrganization="createCoreOrganization",UiPermissionsEnum.viewNoMatchSuppliers="viewNoMatchSuppliers",UiPermissionsEnum.viewDraftOrganizations="viewDraftOrganizations",UiPermissionsEnum.viewNetworkDeclarations="viewNetworkDeclarations",UiPermissionsEnum.accessEvidenceReview="accessEvidenceReview",UiPermissionsEnum.modifyReview="modifyReview",UiPermissionsEnum.manageEvidenceType="manageEvidenceType",UiPermissionsEnum.manageReviewCriteria="manageReviewCriteria",UiPermissionsEnum.userAuthManager="userAuthManager",UiPermissionsEnum.viewEvidenceReview="viewEvidenceReview",UiPermissionsEnum.manageEvidenceTypeMapping="manageEvidenceTypeMapping",UiPermissionsEnum.profileManager="profileManager",UiPermissionsEnum.accessCustomerRequests="accessCustomerRequests",UiPermissionsEnum.accessPartLevelCustomerRequests="accessPartLevelCustomerRequests",UiPermissionsEnum.supplierConsent="supplierConsent"}(UiPermissionsEnum||(UiPermissionsEnum={})),function(UiTokenKeyPermissionsEnum){UiTokenKeyPermissionsEnum.userManagement="ACP.AccessUserManagement",UiTokenKeyPermissionsEnum.exceptionManagement="ACP.AccessExceptionManagement",UiTokenKeyPermissionsEnum.segmentationReport="ACP.AccessSegmentationReport",UiTokenKeyPermissionsEnum.editCompanyProfile="ACP.EditCompanyProfile",UiTokenKeyPermissionsEnum.viewCompanyProfile="ACP.ViewCompanyProfile",UiTokenKeyPermissionsEnum.viewContactManagement="ACP.ViewContactManagement",UiTokenKeyPermissionsEnum.editContactManagement="ACP.EditContactManagement",UiTokenKeyPermissionsEnum.accessDeclarationSearch="ACP.AccessDeclarationSearch",UiTokenKeyPermissionsEnum.accessTransactionLogs="ACP.AccessTransactionLogs",UiTokenKeyPermissionsEnum.accessIndirectMonitoring="ACP.AccessIndirectMonitoring",UiTokenKeyPermissionsEnum.viewIndirectMonitoringRecords="ACP.ViewIndirectMonitoringRecords",UiTokenKeyPermissionsEnum.addIndirectMonitoringRecords="ACP.AddIndirectMonitoringRecords",UiTokenKeyPermissionsEnum.editIndirectMonitoringRecords="ACP.EditIndirectMonitoringRecords",UiTokenKeyPermissionsEnum.deleteIndirectMonitoringRecords="ACP.DeleteIndirectMonitoringRecords",UiTokenKeyPermissionsEnum.viewIndirectMonitoringKeywordsList="ACP.ViewIndirectMonitoringKeywordsList",UiTokenKeyPermissionsEnum.addIndirectMonitoringKeywordsList="ACP.AddIndirectMonitoringKeywordsList",UiTokenKeyPermissionsEnum.editIndirectMonitoringKeywordsList="ACP.EditIndirectMonitoringKeywordsList",UiTokenKeyPermissionsEnum.deleteIndirectMonitoringKeywordsList="ACP.DeleteIndirectMonitoringKeywordsList",UiTokenKeyPermissionsEnum.accessCorrectiveActions="ACP.AccessCorrectiveActions",UiTokenKeyPermissionsEnum.fullViewCorrectiveActionRecords="ACP.FullViewCorrectiveActionRecords",UiTokenKeyPermissionsEnum.addCorrectiveActionRecords="ACP.AddCorrectiveActionRecords",UiTokenKeyPermissionsEnum.editCorrectiveActionRecords="ACP.EditCorrectiveActionRecords",UiTokenKeyPermissionsEnum.deleteCorrectiveActionRecords="ACP.DeleteCorrectiveActionRecords",UiTokenKeyPermissionsEnum.respondToCorrectiveActions="ACP.RespondToCorrectiveActions",UiTokenKeyPermissionsEnum.manageCorrectiveActionTemplates="ACP.ManageCorrectiveActionTemplates",UiTokenKeyPermissionsEnum.viewAssignedCorrectiveActionRecords="ACP.ViewAssignedCorrectiveActionRecords",UiTokenKeyPermissionsEnum.createCoreOrganization="ACP.CreateCoreOrganization",UiTokenKeyPermissionsEnum.viewNoMatchSuppliers="ACP.ViewNoMatchSuppliers",UiTokenKeyPermissionsEnum.viewDraftOrganizations="ACP.ViewDraftOrganizations",UiTokenKeyPermissionsEnum.viewNetworkDeclarations="ACP.ViewNetworkDeclarations",UiTokenKeyPermissionsEnum.accessEvidenceReview="ACP.ER.Access",UiTokenKeyPermissionsEnum.modifyReview="ACP.ER.Review.Modify",UiTokenKeyPermissionsEnum.manageEvidenceType="ACP.ER.EvidenceType.Manage",UiTokenKeyPermissionsEnum.manageReviewCriteria="ACP.ER.ReviewCriteria.Manage",UiTokenKeyPermissionsEnum.manageCorrectiveActionsRulesSet="ACP.ManageCorrectiveActionsRulesSet",UiTokenKeyPermissionsEnum.viewEvidenceReview="ACP.ER.View",UiTokenKeyPermissionsEnum.manageEvidenceTypeMapping="ER.EvidenceTypeMap.Manage",UiTokenKeyPermissionsEnum.accessCustomerRequests="ACP.AccessCustomerRequests",UiTokenKeyPermissionsEnum.accessPartLevelCustomerRequests="ACP.AccessPartLevelCustomerRequests"}(UiTokenKeyPermissionsEnum||(UiTokenKeyPermissionsEnum={}))},"./libs/ui/src/lib/services/user/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{QD:()=>_enums__WEBPACK_IMPORTED_MODULE_0__.Q,b:()=>_user_service__WEBPACK_IMPORTED_MODULE_1__.b});var _enums__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./libs/ui/src/lib/services/user/enums/index.ts"),_user_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./libs/ui/src/lib/services/user/user.service.ts")},"./libs/ui/src/lib/services/user/user.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{b:()=>UiUserService});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.js"),core=__webpack_require__("./node_modules/@angular/core/fesm2020/core.mjs"),http=__webpack_require__("./node_modules/@angular/common/fesm2020/http.mjs"),BehaviorSubject=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/BehaviorSubject.js"),distinctUntilChanged=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/distinctUntilChanged.js"),take=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/take.js"),map=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),ngx_translate_core=__webpack_require__("./node_modules/@ngx-translate/core/__ivy_ngcc__/fesm2015/ngx-translate-core.js"),configuration_service=__webpack_require__("./libs/ui/src/lib/services/configuration/configuration.service.ts"),pendo_service=__webpack_require__("./libs/ui/src/lib/services/analytics/pendo/pendo.service.ts");class UiPermissionsModel{}var enums=__webpack_require__("./libs/ui/src/lib/services/user/enums/index.ts"),lib_enums=__webpack_require__("./libs/ui/src/lib/enums/index.ts"),supportedLanguages_enum=__webpack_require__("./apps/acp-ui/src/app/enums/supportedLanguages.enum.ts");let UiUserService=class UiUserService{constructor(_httpClient,_configService,_pendoService,_translateService){this._httpClient=_httpClient,this._configService=_configService,this._pendoService=_pendoService,this._translateService=_translateService,this._authenticatedUserSubject=new BehaviorSubject.t({}),this._acpPermissionsSubject=new BehaviorSubject.t(new UiPermissionsModel),this.authenticatedUser$=this._authenticatedUserSubject.asObservable().pipe((0,distinctUntilChanged.F)()),this.acpPermissions$=this._acpPermissionsSubject.asObservable().pipe((0,distinctUntilChanged.F)()),this._acpUsersPath="acp/users/",this._getUserPreference_cognito="UserPreference/get",this._getUserPreference_auth0="UserPreference/v2/get",this._setUserPreference_cognito="UserPreference/update",this._setUserPreference_auth0="UserPreference/v2/update"}selectUser(email,permissions){this.setAcpPermissions(permissions),setTimeout((()=>{this._httpClient.get(`${this._configService.appConfig.authApi}${this._acpUsersPath}${email}`).subscribe({next:user=>{user.avatar="admin5.png";const currentEnv=this._configService.appConfig.environmentName;if(currentEnv!==lib_enums.C.localdev&&currentEnv!==lib_enums.C.devopsprod&&currentEnv!==lib_enums.C.devopssandbox){const endpoint=`${this._configService.appConfig.iamApi}`+(this._configService.appConfig.authServiceVersion&&"auth0"===this._configService.appConfig.authServiceVersion?this._getUserPreference_auth0:this._getUserPreference_cognito);this._httpClient.get(endpoint).pipe((0,take.s)(1)).subscribe({next:response=>{if(response.preferences.length>0)this.selectedLanguage=response.preferences[0].value,this.selectedLanguage=this.selectedLanguage.toLowerCase();else{const navigatorLanguageSmallCode=window.navigator.language.slice(0,2);navigatorLanguageSmallCode in supportedLanguages_enum.JS?this.selectedLanguage=navigatorLanguageSmallCode:this.selectedLanguage=supportedLanguages_enum.kV.en}user.preferredLanguage=this.selectedLanguage;const lang2letter=supportedLanguages_enum.JS[this.selectedLanguage];this._translateService.use(lang2letter),this._authenticatedUserSubject.next(user)},error:err=>{user.preferredLanguage="",this._authenticatedUserSubject.next(user)}})}else user.preferredLanguage="",this._authenticatedUserSubject.next(user)},error:err=>{console.error("Pendo NOT initialized properly!!!"),console.error(err)}})}),250)}savePreferredLanguage(code){const body={Preferences:{Language:[code[0].toUpperCase()+code.slice(1)]}},endpoint=`${this._configService.appConfig.iamApi}`+(this._configService.appConfig.authServiceVersion&&"auth0"===this._configService.appConfig.authServiceVersion?this._setUserPreference_auth0:this._setUserPreference_cognito);return this._httpClient.post(endpoint,body)}logout(){this._configService.appConfig.enablePendoAcpUi&&this._pendoService.anonymizeVisitorInfo(),this._authenticatedUserSubject.next(null),this._acpPermissionsSubject.next(new UiPermissionsModel)}hasPermission(requiredPermissions){return this.acpPermissions$.pipe((0,map.T)((permissions=>{if(!Array.isArray(requiredPermissions))return!1;if(null===requiredPermissions[0]||0===requiredPermissions.length)return!0;return requiredPermissions.reduce(((a,b)=>a.concat(b)),[]).some((requiredPermission=>permissions[requiredPermission]))})),(0,distinctUntilChanged.F)())}isSupplierUser(){return this.acpPermissions$.pipe((0,map.T)((permissions=>permissions.viewAssignedCorrectiveActionRecords&&!permissions.fullViewCorrectiveActionRecords)))}setAcpPermissions(permissions){const acpPermissions={userManagement:"true"===permissions[enums.U.userManagement],exceptionManagement:"true"===permissions[enums.U.exceptionManagement],segmentationReport:"true"===permissions[enums.U.segmentationReport],editCompanyProfile:"true"===permissions[enums.U.editCompanyProfile],viewCompanyProfile:"true"===permissions[enums.U.viewCompanyProfile],viewContactManagement:"true"===permissions[enums.U.viewContactManagement],editContactManagement:"true"===permissions[enums.U.editContactManagement],accessDeclarationSearch:"true"===permissions[enums.U.accessDeclarationSearch],accessTransactionLogs:"true"===permissions[enums.U.accessTransactionLogs],accessIndirectMonitoring:"true"===permissions[enums.U.accessIndirectMonitoring],viewIndirectMonitoringRecords:"true"===permissions[enums.U.viewIndirectMonitoringRecords],addIndirectMonitoringRecords:"true"===permissions[enums.U.addIndirectMonitoringRecords],editIndirectMonitoringRecords:"true"===permissions[enums.U.editIndirectMonitoringRecords],deleteIndirectMonitoringRecords:"true"===permissions[enums.U.deleteIndirectMonitoringRecords],viewIndirectMonitoringKeywordsList:"true"===permissions[enums.U.viewIndirectMonitoringKeywordsList],addIndirectMonitoringKeywordsList:"true"===permissions[enums.U.addIndirectMonitoringKeywordsList],editIndirectMonitoringKeywordsList:"true"===permissions[enums.U.editIndirectMonitoringKeywordsList],deleteIndirectMonitoringKeywordsList:"true"===permissions[enums.U.deleteIndirectMonitoringKeywordsList],accessCorrectiveActions:"true"===permissions[enums.U.accessCorrectiveActions],fullViewCorrectiveActionRecords:"true"===permissions[enums.U.fullViewCorrectiveActionRecords],viewAssignedCorrectiveActionRecords:"true"===permissions[enums.U.viewAssignedCorrectiveActionRecords],addCorrectiveActionRecords:"true"===permissions[enums.U.addCorrectiveActionRecords],editCorrectiveActionRecords:"true"===permissions[enums.U.editCorrectiveActionRecords],deleteCorrectiveActionRecords:"true"===permissions[enums.U.deleteCorrectiveActionRecords],respondToCorrectiveActions:"true"===permissions[enums.U.respondToCorrectiveActions],manageCorrectiveActionTemplates:"true"===permissions[enums.U.manageCorrectiveActionTemplates],createCoreOrganization:"true"===permissions[enums.U.createCoreOrganization],viewNoMatchSuppliers:"true"===permissions[enums.U.viewNoMatchSuppliers],viewDraftOrganizations:"true"===permissions[enums.U.viewDraftOrganizations],viewNetworkDeclarations:"true"===permissions[enums.U.viewNetworkDeclarations],accessEvidenceReview:"true"===permissions[enums.U.accessEvidenceReview],modifyReview:"true"===permissions[enums.U.modifyReview],manageEvidenceType:"true"===permissions[enums.U.manageEvidenceType],manageReviewCriteria:"true"===permissions[enums.U.manageReviewCriteria],manageCorrectiveActionsRulesSet:"true"===permissions[enums.U.manageCorrectiveActionsRulesSet],viewEvidenceReview:"true"===permissions[enums.U.viewEvidenceReview],manageEvidenceTypeMapping:"true"===permissions[enums.U.manageEvidenceTypeMapping],accessCustomerRequests:"true"===permissions[enums.U.accessCustomerRequests],accessPartLevelCustomerRequests:"true"===permissions[enums.U.accessPartLevelCustomerRequests],aud:permissions.aud};this._acpPermissionsSubject.next(acpPermissions),this._configService.appConfig.enablePendoAcpUi&&this._pendoService.setAuthenticatedVisitorPermissions(acpPermissions)}};UiUserService.ctorParameters=()=>[{type:http.Qq},{type:configuration_service.c},{type:pendo_service.I},{type:ngx_translate_core.c$}],UiUserService=(0,tslib_es6.Cg)([(0,core.Injectable)({providedIn:"root"}),(0,tslib_es6.Sn)("design:paramtypes",[http.Qq,configuration_service.c,pendo_service.I,ngx_translate_core.c$])],UiUserService)}}]);